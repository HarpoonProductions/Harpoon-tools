<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Harpoon Timeline Builder v1.7.0</title>

<style>
/* =========================================================
   BUILDER UI ONLY (never exported)
   ========================================================= */
body{
  font-family: system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
  margin:0;
  padding:24px;
  background:#fafafa;
  color:#111;
}
h1{ font-size:22px; margin:0 0 14px; }
.builder{ max-width: 980px; margin:0 auto 40px; }

fieldset{
  background:#fff;
  border:1px solid #ddd;
  border-radius:12px;
  padding:16px;
  margin:0 0 16px;
}

label{
  display:block;
  font-size:12px;
  font-weight:700;
  margin:10px 0 6px;
}

input[type="text"],
textarea,
select{
  width:100%;
  box-sizing:border-box;
  padding:10px;
  border:1px solid #ccc;
  border-radius:10px;
  font-size:14px;
}

textarea{ min-height:92px; resize:vertical; }

.row{
  display:grid;
  grid-template-columns: 1fr 1fr;
  gap:14px;
  align-items:end;
}

.actions{
  display:flex;
  gap:10px;
  flex-wrap:wrap;
  margin-top:12px;
}

button{
  appearance:none;
  border:0;
  border-radius:10px;
  padding:10px 14px;
  font-size:14px;
  cursor:pointer;
}

button.primary{ background:#111; color:#fff; }
button.secondary{ background:#eee; color:#111; }
button.warn{ background:#f5dcdc; color:#700; }

.helper{
  font-size:12px;
  color:#666;
  margin-top:4px;
}

/* =========================================================
   PREVIEW FRAME (builder only)
   ========================================================= */
.preview{
  background:#fff;
  border:1px solid #ddd;
  border-radius:12px;
  overflow:hidden;
}

.preview__scroller{
  overflow-x:auto;
  -webkit-overflow-scrolling: touch;
  padding: 18px 0;
  cursor: grab;
  user-select: none;
}
.preview__scroller:active{ cursor: grabbing; }

/* =========================================================
   RUNTIME PREVIEW CSS (matches exported CSS)
   ========================================================= */

.harpoon-timeline-block{
  position: relative;
}

.harpoon-timeline__title{
  position: sticky;
  top: 0;
  z-index: 5;
  text-align: center;
  padding: 8px 0;
  margin-bottom: 12px;
  font-weight: 700;
  font-size: 1.5rem;
  background: #fff;
}

.harpoon-timeline-wrapper{
  overflow-x:auto;
  -webkit-overflow-scrolling: touch;
}

.harpoon-timeline{
  --harpoon-line-y: 40px;
  --harpoon-line-thickness: 3px;
  --harpoon-line-color: #d0a3c4;
  --harpoon-dot-color: #7a1c5c;
  --harpoon-dot-size: 12px;
  --harpoon-dot-border: 0px;
  --harpoon-dot-fill: var(--harpoon-dot-color);

  position: relative;
  display: flex;
  gap: 32px;
  padding: 0 20px 20px;
  width: max-content;
}

.harpoon-timeline__line{
  position:absolute;
  top: var(--harpoon-line-y);
  left:0;
  right:0;
  height: var(--harpoon-line-thickness);
  background: var(--harpoon-line-color);
  opacity: .4;
  transform: translateY(-50%);
}

.harpoon-timeline__item{
  position:relative;
  width: min(320px, 88vw);
  flex-shrink:0;
  padding-top: calc(var(--harpoon-line-y) + var(--harpoon-dot-size) + 8px);
  cursor: pointer;
}

.harpoon-timeline__marker{
  position:absolute;
  top: var(--harpoon-line-y);
  left: 50%;
  width: var(--harpoon-dot-size);
  height: var(--harpoon-dot-size);
  transform: translate(-50%, -50%);
  background: var(--harpoon-dot-fill);
  border: var(--harpoon-dot-border) solid var(--harpoon-dot-color);
  border-radius:50%;
}

.harpoon-timeline__date{
  margin: 0 0 12px;
  font-weight:700;
  text-align:center;
}

.harpoon-timeline__card{
  background:#fff;
  border-radius:16px;
  padding:16px;
  box-shadow: 0 10px 30px rgba(0,0,0,0.08);
  border: 1px solid rgba(0,0,0,0.04);
}

.harpoon-timeline__image{
  width:100%;
  border-radius:12px;
  background-position:center;
  background-repeat:no-repeat;
  margin-bottom:6px;
}

.harpoon-timeline__image--crop{
  aspect-ratio: 16 / 9;
  background-size: cover;
}

.harpoon-timeline__image:not(.harpoon-timeline__image--crop){
  background-size: contain;
  min-height: 160px;
}

.harpoon-timeline__credit{
  font-size:11px;
  text-align:right;
  opacity:.65;
  letter-spacing:.04em;
  margin:0 0 6px;
}

/* =========================================================
   MODAL (builder only)
   ========================================================= */
.modal{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.45);
  display:none;
  align-items:center;
  justify-content:center;
  z-index:9999;
}
.modal.open{ display:flex; }

.modal__box{
  width:min(980px, 92vw);
  background:#fff;
  border-radius:14px;
  overflow:hidden;
}

.modal__tabs{
  display:flex;
  border-bottom:1px solid #ddd;
}

.modal__tabs button{
  flex:1;
  font-weight:700;
  background:#f5f5f5;
}

.modal__tabs button.active{ background:#fff; }

.modal__content{
  padding:14px;
  max-height:60vh;
  overflow:auto;
  font-family: monospace;
  font-size:12px;
  white-space:pre;
}

.modal__footer{
  display:flex;
  justify-content:space-between;
  padding:12px;
  border-top:1px solid #ddd;
}
</style>
</head>

<body>

<div class="builder">
  <h1>Harpoon Timeline Builder v1.7.0</h1>

  <fieldset>
    <label>Timeline title</label>
    <input type="text" id="titleInput" placeholder="e.g. Tom Whidden: A Life in Sailing">
  </fieldset>

  <fieldset>
    <label>Date</label>
    <input type="text" id="dateInput">

    <label>Body text (HTML allowed)</label>
    <textarea id="textInput"></textarea>

    <label>Image URL (optional)</label>
    <input type="text" id="imageInput">

    <label>
      <input type="checkbox" id="cropInput" checked>
      Crop image to 16:9
    </label>

    <label>Image credit (optional)</label>
    <input type="text" id="creditInput">

    <div class="actions">
      <button class="primary" id="addBtn">Add entry</button>
      <button class="secondary" id="cancelEditBtn" style="display:none">Cancel edit</button>
      <button class="secondary" id="exportBtn">Export HTML / CSS</button>
      <button class="warn" id="clearBtn">Clear all</button>
    </div>
  </fieldset>

  <div class="preview">
    <div class="preview__scroller" id="previewScroller">
      <div class="harpoon-timeline-block">
        <div class="harpoon-timeline__title" id="previewTitle"></div>
        <div class="harpoon-timeline-wrapper">
          <div class="harpoon-timeline" id="previewTimeline">
            <div class="harpoon-timeline__line"></div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="modal" id="modal">
  <div class="modal__box">
    <div class="modal__tabs">
      <button id="tabHtml" class="active">HTML</button>
      <button id="tabCss">CSS</button>
    </div>
    <div class="modal__content" id="modalContent"></div>
    <div class="modal__footer">
      <button class="secondary" id="closeModalBtn">Close</button>
      <button class="primary" id="copyBtn">Copy</button>
    </div>
  </div>
</div>

<script>
(() => {
  const entries = [];
  let editingIndex = null;

  const $ = id => document.getElementById(id);

  const titleInput = $("titleInput");
  const previewTitle = $("previewTitle");

  const dateInput = $("dateInput");
  const textInput = $("textInput");
  const imageInput = $("imageInput");
  const creditInput = $("creditInput");
  const cropInput = $("cropInput");

  const addBtn = $("addBtn");
  const cancelEditBtn = $("cancelEditBtn");

  const previewTimeline = $("previewTimeline");

  function render(){
    previewTitle.textContent = titleInput.value;

    previewTimeline.innerHTML = '<div class="harpoon-timeline__line"></div>';

    entries.forEach((e,i)=>{
      const el = document.createElement("div");
      el.className = "harpoon-timeline__item";
      el.onclick = () => editEntry(i);

      el.innerHTML = `
        <div class="harpoon-timeline__marker"></div>
        <div class="harpoon-timeline__date">${e.date}</div>
        <div class="harpoon-timeline__card">
          ${e.image ? `
            <div class="harpoon-timeline__image ${e.crop ? 'harpoon-timeline__image--crop' : ''}"
                 style="background-image:url('${e.image}')"></div>` : ""}
          ${e.credit ? `<div class="harpoon-timeline__credit">${e.credit}</div>` : ""}
          ${e.text}
        </div>
      `;
      previewTimeline.appendChild(el);
    });
  }

  function editEntry(i){
    const e = entries[i];
    editingIndex = i;
    dateInput.value = e.date;
    textInput.value = e.text;
    imageInput.value = e.image;
    creditInput.value = e.credit;
    cropInput.checked = e.crop;
    addBtn.textContent = "Update entry";
    cancelEditBtn.style.display = "inline-block";
  }

  cancelEditBtn.onclick = () => {
    editingIndex = null;
    dateInput.value = textInput.value = imageInput.value = creditInput.value = "";
    cropInput.checked = true;
    addBtn.textContent = "Add entry";
    cancelEditBtn.style.display = "none";
  };

  addBtn.onclick = () => {
    const data = {
      date: dateInput.value,
      text: textInput.value,
      image: imageInput.value,
      credit: creditInput.value,
      crop: cropInput.checked
    };

    if(editingIndex !== null){
      entries[editingIndex] = data;
    } else {
      entries.push(data);
    }

    cancelEditBtn.onclick();
    render();
  };

  titleInput.oninput = render;

  $("clearBtn").onclick = () => {
    entries.length = 0;
    render();
  };

  render();
})();
</script>

</body>
</html>
