<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Harpoon Timeline Builder v1.7.4b</title>

<style>
/* =========================================================
   BUILDER UI ONLY
   ========================================================= */
body{
  font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
  margin:0;
  padding:24px;
  background:#fafafa;
  color:#111;
}
h1{font-size:22px;margin:0 0 14px}
.builder{max-width:980px;margin:0 auto 40px}

fieldset{
  background:#fff;
  border:1px solid #ddd;
  border-radius:12px;
  padding:16px;
  margin-bottom:16px
}

label{
  display:block;
  font-size:12px;
  font-weight:700;
  margin:10px 0 6px
}

input,textarea,select{
  width:100%;
  padding:10px;
  border:1px solid #ccc;
  border-radius:10px;
  font-size:14px;
  box-sizing:border-box
}
textarea{min-height:90px}

.controls-grid{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:20px
}
.control-stack > * + *{margin-top:10px}

.dot-picker{
  display:flex;
  align-items:center;
  gap:10px
}
.dot-preview{
  width:14px;
  height:14px;
  border-radius:50%;
  border:1px solid #ccc
}

.inline-toggle{
  display:flex;
  align-items:center;
  gap:8px;
  margin-top:6px
}
.inline-toggle label{
  margin:0;
  font-weight:600;
  font-size:13px
}

.actions{
  display:flex;
  gap:10px;
  flex-wrap:wrap;
  margin-top:12px
}
button{
  border:0;
  border-radius:10px;
  padding:10px 14px;
  font-size:14px;
  cursor:pointer
}
.primary{background:#111;color:#fff}
.secondary{background:#eee}

.required{color:#c00;font-weight:700}

/* =========================================================
   PREVIEW
   ========================================================= */
.preview{
  background:#fff;
  border:1px solid #ddd;
  border-radius:12px;
  overflow:hidden
}
.preview__scroller{
  overflow-x:auto;
  -webkit-overflow-scrolling:touch;
  padding:18px 0;
  cursor:grab
}

/* =========================================================
   TIMELINE RUNTIME (matches export)
   ========================================================= */
.harpoon-timeline-block{position:relative}

.harpoon-timeline__title{
  position:sticky;
  top:0;
  z-index:5;
  text-align:center;
  padding:10px 0;
  background:#fff;
  font-weight:700;
  font-size:1.5rem
}

.harpoon-timeline-wrapper{
  overflow-x:auto;
  -webkit-overflow-scrolling:touch;
  touch-action:pan-x
}

.harpoon-timeline{
  --harpoon-line-y:40px;
  --harpoon-line-thickness:3px;
  --harpoon-line-color:#a3a3a3;
  --harpoon-dot-color:#000;
  --harpoon-dot-size:12px;
  --harpoon-dot-border:0px;
  --harpoon-dot-fill:var(--harpoon-dot-color);
  position:relative;
  display:flex;
  gap:32px;
  padding:0 20px 20px;
  width:max-content
}

.harpoon-timeline__line{
  position:absolute;
  top:var(--harpoon-line-y);
  left:0;right:0;
  height:var(--harpoon-line-thickness);
  background:var(--harpoon-line-color);
  opacity:.4;
  transform:translateY(-50%)
}

.harpoon-timeline__item{
  position:relative;
  width:min(320px,88vw);
  flex-shrink:0;
  padding-top:calc(var(--harpoon-line-y) + var(--harpoon-dot-size) + 8px)
}
.harpoon-timeline__item:focus-visible{
  outline:3px solid rgba(0,0,0,.35);
  outline-offset:6px
}

.harpoon-timeline__marker{
  position:absolute;
  top:var(--harpoon-line-y);
  left:50%;
  width:var(--harpoon-dot-size);
  height:var(--harpoon-dot-size);
  transform:translate(-50%,-50%);
  background:var(--harpoon-dot-fill);
  border:var(--harpoon-dot-border) solid var(--harpoon-dot-color);
  border-radius:50%
}

.harpoon-timeline__date{
  margin:0 0 12px;
  font-weight:700;
  text-align:center
}

.harpoon-timeline__card{
  background:#fff;
  border-radius:16px;
  padding:16px;
  box-shadow:0 10px 30px rgba(0,0,0,.08);
  border:1px solid rgba(0,0,0,.04)
}

.harpoon-timeline__image{
  width:100%;
  border-radius:12px;
  display:block;
  margin-bottom:6px
}
.harpoon-timeline__image--crop{
  aspect-ratio:16/9;
  object-fit:cover
}
.harpoon-timeline__image--contain{
  object-fit:contain
}

.harpoon-timeline__credit{
  font-size:11px;
  opacity:.65;
  text-align:right;
  margin-bottom:6px
}

/* =========================================================
   EXPORT MODAL
   ========================================================= */
.modal{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.45);
  display:none;
  align-items:center;
  justify-content:center;
  z-index:9999
}
.modal.open{display:flex}
.modal__box{
  width:min(980px,92vw);
  background:#fff;
  border-radius:14px;
  overflow:hidden
}
.modal__tabs{
  display:flex;
  border-bottom:1px solid #ddd;
  background:#f7f7f7
}
.modal__tabs button{
  flex:1;
  padding:12px;
  font-weight:800;
  background:none
}
.modal__tabs .active{background:#fff}
.modal__content{
  padding:14px 16px;
  max-height:60vh;
  overflow:auto;
  font-family:ui-monospace,monospace;
  font-size:12.5px;
  white-space:pre
}
.modal__footer{
  display:flex;
  justify-content:space-between;
  padding:12px 16px;
  border-top:1px solid #ddd
}

/* =========================================================
   FOOTER
   ========================================================= */
.builder-footer{
  margin-top:24px;
  text-align:center;
  font-size:13px;
  opacity:.6
}
.builder-footer img{
  width:22px;
  vertical-align:middle;
  margin-right:6px
}
</style>
</head>

<body>

<div class="builder">
<h1>Harpoon Timeline Builder v1.7.4b</h1>

<fieldset>
  <label>Timeline title</label>
  <input id="titleInput" type="text" placeholder="e.g. Tom Whidden â€” Career Timeline">
</fieldset>

<fieldset>
  <div class="controls-grid">
    <div class="control-stack">
      <label>Line colour</label>
      <input type="color" id="lineColor" value="#a3a3a3">
      <label>Line thickness</label>
      <select id="lineThickness">
        <option value="2">2px</option>
        <option value="3" selected>3px</option>
        <option value="4">4px</option>
      </select>
    </div>

    <div class="control-stack">
      <label>Marker colour</label>
      <div class="dot-picker">
        <span class="dot-preview" id="dotPreview"></span>
        <input type="color" id="dotColor" value="#000000">
      </div>
      <label>Marker style</label>
      <select id="markerStyle">
        <option value="dot-small">Small dot</option>
        <option value="dot-big">Big dot</option>
        <option value="circle-open">Open circle</option>
      </select>
    </div>
  </div>
</fieldset>

<fieldset>
  <label>Date</label>
  <input id="dateInput" type="text">

  <label>Body text (HTML allowed)</label>
  <textarea id="textInput"></textarea>

  <label>Image URL</label>
  <input id="imageInput" type="text">

  <label>Image alt text <span class="required">*</span></label>
  <input id="altInput" type="text">

  <div class="inline-toggle">
    <input type="checkbox" id="cropToggle" checked>
    <label for="cropToggle">Crop image to 16:9</label>
  </div>

  <label>Image credit (optional)</label>
  <input id="creditInput" type="text">

  <div class="actions">
    <button class="primary" id="addBtn">Add / Update entry</button>
    <button class="secondary" id="exportBtn">Export HTML / CSS</button>
    <button class="secondary" id="importBtn">Import existing timeline</button>
    <button class="secondary" id="clearBtn">Clear all</button>
  </div>
</fieldset>

<div class="preview">
  <div class="preview__scroller" id="previewScroller">
    <div class="harpoon-timeline-block">
      <div class="harpoon-timeline__title" id="previewTitle"></div>
      <div class="harpoon-timeline-wrapper">
        <div class="harpoon-timeline" id="previewTimeline">
          <div class="harpoon-timeline__line"></div>
        </div>
      </div>
    </div>
  </div>
</div>
</div>

<!-- Export Modal -->
<div class="modal" id="modal">
  <div class="modal__box">
    <div class="modal__tabs">
      <button id="tabHtml" class="active">HTML</button>
      <button id="tabCss">CSS</button>
    </div>
    <div class="modal__content" id="modalContent"></div>
    <div class="modal__footer">
      <button class="secondary" id="closeModalBtn">Close</button>
      <button class="primary" id="copyBtn">Copy</button>
    </div>
  </div>
</div>

<div class="builder-footer">
  <img src="https://pbs.twimg.com/profile_images/1200397581333024768/kEKej87-_400x400.jpg" alt="">
  Harpoon Productions
</div>

<script>
(() => {
  const entries=[];
  let editIndex=null;

  const $=id=>document.getElementById(id);
  const previewTimeline=$("previewTimeline");
  const previewTitle=$("previewTitle");

  function markerVars(){
    if(markerStyle.value==="dot-big")return{size:16,border:0,fill:"var(--harpoon-dot-color)"};
    if(markerStyle.value==="circle-open")return{size:14,border:2,fill:"transparent"};
    return{size:10,border:0,fill:"var(--harpoon-dot-color)"};
  }

  function applyVars(){
    const m=markerVars();
    previewTimeline.style.setProperty("--harpoon-line-color",lineColor.value);
    previewTimeline.style.setProperty("--harpoon-dot-color",dotColor.value);
    previewTimeline.style.setProperty("--harpoon-line-thickness",lineThickness.value+"px");
    previewTimeline.style.setProperty("--harpoon-dot-size",m.size+"px");
    previewTimeline.style.setProperty("--harpoon-dot-border",m.border+"px");
    previewTimeline.style.setProperty("--harpoon-dot-fill",m.fill);
    dotPreview.style.background=dotColor.value;
  }

  function render(){
    previewTimeline.innerHTML='<div class="harpoon-timeline__line"></div>';
    previewTitle.textContent=titleInput.value;

    entries.forEach((e,i)=>{
      const d=document.createElement("div");
      d.className="harpoon-timeline__item";
      d.tabIndex=0;
      d.innerHTML=`
        <div class="harpoon-timeline__marker"></div>
        <div class="harpoon-timeline__date">${e.date}</div>
        <div class="harpoon-timeline__card">
          ${e.image?`<img class="harpoon-timeline__image ${e.crop?"harpoon-timeline__image--crop":"harpoon-timeline__image--contain"}" src="${e.image}" alt="${e.alt}">`:""}
          ${e.credit?`<div class="harpoon-timeline__credit">${e.credit}</div>`:""}
          ${e.text}
        </div>`;
      d.onclick=()=>loadForEdit(i);
      previewTimeline.appendChild(d);
    });

    applyVars();
  }

  function loadForEdit(i){
    const e=entries[i];
    editIndex=i;
    dateInput.value=e.date;
    textInput.value=e.text;
    imageInput.value=e.image;
    altInput.value=e.alt;
    creditInput.value=e.credit;
    cropToggle.checked=e.crop;
  }

  addBtn.onclick=()=>{
    if(!altInput.value.trim() && imageInput.value.trim()){
      alert("Alt text is required when an image is used.");
      return;
    }
    const data={
      date:dateInput.value,
      text:textInput.value,
      image:imageInput.value,
      alt:altInput.value,
      credit:creditInput.value,
      crop:cropToggle.checked
    };
    if(editIndex!==null){
      entries[editIndex]=data;
      editIndex=null;
    }else{
      entries.push(data);
    }
    dateInput.value=textInput.value=imageInput.value=altInput.value=creditInput.value="";
    cropToggle.checked=true;
    render();
  };

  clearBtn.onclick=()=>{entries.length=0;render();};

  exportBtn.onclick=()=>{
    modal.classList.add("open");
    tabHtml.click();
  };
  closeModalBtn.onclick=()=>modal.classList.remove("open");

  tabHtml.onclick=()=>{
    tabHtml.classList.add("active");
    tabCss.classList.remove("active");
    modalContent.textContent=exportHTML();
  };
  tabCss.onclick=()=>{
    tabCss.classList.add("active");
    tabHtml.classList.remove("active");
    modalContent.textContent=exportCSS();
  };
  copyBtn.onclick=()=>navigator.clipboard.writeText(modalContent.textContent);

  function exportHTML(){
    return `<div class="harpoon-timeline-block">
  ${titleInput.value?`<div class="harpoon-timeline__title">${titleInput.value}</div>`:""}
  <div class="harpoon-timeline-wrapper">
    <div class="harpoon-timeline">
      <div class="harpoon-timeline__line"></div>
${entries.map(e=>`      <div class="harpoon-timeline__item" tabindex="0">
        <div class="harpoon-timeline__marker"></div>
        <div class="harpoon-timeline__date">${e.date}</div>
        <div class="harpoon-timeline__card">
          ${e.image?`<img class="harpoon-timeline__image ${e.crop?"harpoon-timeline__image--crop":"harpoon-timeline__image--contain"}" src="${e.image}" alt="${e.alt}">`:""}
          ${e.credit?`<div class="harpoon-timeline__credit">${e.credit}</div>`:""}
          ${e.text}
        </div>
      </div>`).join("\n")}
    </div>
  </div>
</div>`;
  }

  function exportCSS(){
    return document.querySelector("style").innerText.split("/* =========================================================\n   EXPORT MODAL")[0];
  }

  [lineColor,dotColor,markerStyle,lineThickness,titleInput].forEach(el=>el.oninput=render);
  applyVars();render();
})();
</script>

</body>
</html>
